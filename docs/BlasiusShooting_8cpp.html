<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CppNoddy: Tests/BVP/BlasiusShooting.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-52977984-1', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CppNoddy
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_33c78a012c8d08979f57a54a07694c46.html">Tests</a></li><li class="navelem"><a class="el" href="dir_fdbddb91d8341d93e941f08b015c4c32.html">BVP</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">BlasiusShooting.cpp File Reference<div class="ingroups"><a class="el" href="group__Tests.html">Tests</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Solving the Blasius equation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="IVP__bundle_8h_source.html">IVP_bundle.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="Utils__Fill_8h_source.html">../Utils_Fill.h</a>&quot;</code><br />
</div>
<p><a href="BlasiusShooting_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1Example_1_1Blasius__equation.html">CppNoddy::Example::Blasius_equation</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define the Blasius equation by inheriting <a class="el" href="classCppNoddy_1_1Equation.html" title="An equation object base class used in the BVP/IVP classes.">Equation</a> base class.  <a href="classCppNoddy_1_1Example_1_1Blasius__equation.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1Example_1_1Blasius__residual.html">CppNoddy::Example::Blasius_residual</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define a residual function using the boundary conditions for the Blasius profile.  <a href="classCppNoddy_1_1Example_1_1Blasius__residual.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceCppNoddy"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCppNoddy.html">CppNoddy</a></td></tr>
<tr class="memdesc:namespaceCppNoddy"><td class="mdescLeft">&#160;</td><td class="mdescRight">A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceCppNoddy_1_1Example"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCppNoddy_1_1Example.html">CppNoddy::Example</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="BlasiusShooting_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
<tr class="separator:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Solving the Blasius equation. </p>
<p class="formulaDsp">
<picture><source srcset="form_83_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[ f'''(y) + f(y) f''(y) = 0\,, \]" src="form_83.png" width="130" height="15"/></picture>
</p>
<p> with <picture><source srcset="form_70_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ f(0)=f'(0)=0 $" src="form_70.png" width="89" height="14"/></picture> and <picture><source srcset="form_71_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ f'(\infty) = 1 $" src="form_71.png" width="55" height="14"/></picture> via Runge-Kutta and (scalar) Newton iteration.</p>
<p >Solving a BVP via local methods such as these is generally not a great way of doing things. Actually, in this case the BVP can formally be converted to an IVP and iteration can be avoided altogether. Here we check the iteration plus IVP approach by comparing it with the Cauchy problem formulation. </p>

<p class="definition">Definition in file <a class="el" href="BlasiusShooting_8cpp_source.html">BlasiusShooting.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae66f6b31b5ad750f1fe042a706a4e3d4" name="ae66f6b31b5ad750f1fe042a706a4e3d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66f6b31b5ad750f1fe042a706a4e3d4">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="BlasiusShooting_8cpp_source.html#l00092">92</a> of file <a class="el" href="BlasiusShooting_8cpp_source.html">BlasiusShooting.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   93</span>{</div>
<div class="line"><span class="lineno">   94</span>  cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">   95</span>  cout &lt;&lt; <span class="stringliteral">&quot;=== BVP_Shoot: scalar Newton solution of Blasius ====\n&quot;</span>;</div>
<div class="line"><span class="lineno">   96</span>  cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>  Example::Blasius_residual problem;</div>
<div class="line"><span class="lineno">   99</span>  <span class="comment">// instantiate a scalar Newton class for the one Blasius residual</span></div>
<div class="line"><span class="lineno">  100</span>  <a class="code hl_class" href="classCppNoddy_1_1Newton.html">Newton&lt;double&gt;</a> Blasius( &amp;problem );</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>  <a class="code hl_class" href="classCppNoddy_1_1DenseVector.html">DenseVector&lt;double&gt;</a> stress( 1, 0.0 );</div>
<div class="line"><span class="lineno">  103</span>  stress[ 0 ] = 1.0;</div>
<div class="line"><span class="lineno">  104</span>  <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  105</span>  {</div>
<div class="line"><span class="lineno">  106</span>    Blasius.iterate( stress );</div>
<div class="line"><span class="lineno">  107</span>  }</div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::runtime_error &amp;error )</div>
<div class="line"><span class="lineno">  109</span>  {</div>
<div class="line"><span class="lineno">  110</span>    cout &lt;&lt; <span class="stringliteral">&quot; \033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \033[0m\n&quot;</span>;</div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  112</span>  }</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>  <span class="comment">// output the data</span></div>
<div class="line"><span class="lineno">  115</span>  std::string dirname(<span class="stringliteral">&quot;./DATA&quot;</span>);</div>
<div class="line"><span class="lineno">  116</span>  mkdir( dirname.c_str(), S_IRWXU );</div>
<div class="line"><span class="lineno">  117</span>  <a class="code hl_class" href="classCppNoddy_1_1TrackerFile.html">TrackerFile</a> my_file( <span class="stringliteral">&quot;./DATA/Blasius.dat&quot;</span> );</div>
<div class="line"><span class="lineno">  118</span>  my_file.push_ptr( &amp;( problem.ode -&gt; get_mesh() ) );</div>
<div class="line"><span class="lineno">  119</span>  my_file.update();</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <span class="comment">// There is a rescaling that removes any need to iterate</span></div>
<div class="line"><span class="lineno">  122</span>  <span class="comment">// c = f&#39;(infty) when stress = 1 at the plate</span></div>
<div class="line"><span class="lineno">  123</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> c = 1.65519036023e0;</div>
<div class="line"><span class="lineno">  124</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> answer = 1. / pow( c, 3. / 2. );</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> tol( 1.e-6 );          <span class="comment">// A pass/fail tolerance</span></div>
<div class="line"><span class="lineno">  127</span>  <span class="keywordflow">if</span> ( abs( stress[0] - answer ) &gt; tol )</div>
<div class="line"><span class="lineno">  128</span>  {</div>
<div class="line"><span class="lineno">  129</span>    cout &lt;&lt; <span class="stringliteral">&quot;\033[1;31;48m  * FAILED \033[0m\n&quot;</span>;</div>
<div class="line"><span class="lineno">  130</span>    cout.precision( 14 );</div>
<div class="line"><span class="lineno">  131</span>    cout &lt;&lt; abs( stress[0] - answer ) &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span> &lt;&lt; tol &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  133</span>  }</div>
<div class="line"><span class="lineno">  134</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  135</span>  {</div>
<div class="line"><span class="lineno">  136</span>    cout &lt;&lt; <span class="stringliteral">&quot;\033[1;32;48m  * PASSED \033[0m\n&quot;</span>;</div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  138</span>  }</div>
<div class="line"><span class="lineno">  139</span>}</div>
<div class="ttc" id="aclassCppNoddy_1_1DenseVector_html"><div class="ttname"><a href="classCppNoddy_1_1DenseVector.html">CppNoddy::DenseVector</a></div><div class="ttdoc">An DenseVector class – a dense vector object.</div><div class="ttdef"><b>Definition:</b> <a href="DenseVector_8h_source.html#l00034">DenseVector.h:34</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1Newton_html"><div class="ttname"><a href="classCppNoddy_1_1Newton.html">CppNoddy::Newton</a></div><div class="ttdoc">A vector NEWTON iteration class.</div><div class="ttdef"><b>Definition:</b> <a href="Newton_8h_source.html#l00025">Newton.h:25</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1TrackerFile_html"><div class="ttname"><a href="classCppNoddy_1_1TrackerFile.html">CppNoddy::TrackerFile</a></div><div class="ttdef"><b>Definition:</b> <a href="TrackerFile_8h_source.html#l00017">TrackerFile.h:17</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Newton_8cpp_source.html#l00035">CppNoddy::Newton&lt; _Type &gt;::iterate()</a>, <a class="el" href="BlasiusShooting_8cpp_source.html#l00051">CppNoddy::Example::Blasius_residual::ode</a>, <a class="el" href="TrackerFile_8cpp_source.html#l00027">CppNoddy::TrackerFile::push_ptr()</a>, and <a class="el" href="TrackerFile_8cpp_source.html#l00118">CppNoddy::TrackerFile::update()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 1 1980 00:00:00 for CppNoddy by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.5
</small></address>
<p>&copy; 2012 </p> <a href="http://hewitt.ddns.net"> R.E. Hewitt</a>
</body>
</html>
