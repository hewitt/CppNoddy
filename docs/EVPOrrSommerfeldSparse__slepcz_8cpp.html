<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CppNoddy: Tests/EVP/EVPOrrSommerfeldSparse_slepcz.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-52977984-1', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CppNoddy
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_33c78a012c8d08979f57a54a07694c46.html">Tests</a></li><li class="navelem"><a class="el" href="dir_7a7020816f14e6538e163000a128fc8a.html">EVP</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">EVPOrrSommerfeldSparse_slepcz.cpp File Reference<div class="ingroups"><a class="el" href="group__Tests.html">Tests</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Solves the following linear eigenvalue problem for values <picture><source srcset="form_123_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ c $" src="form_123.png" width="5" height="6"/></picture> that satisfy :  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="Generic__bundle_8h_source.html">Generic_bundle.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="SparseLinearEigenSystem_8h_source.html">SparseLinearEigenSystem.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="SlepcSession_8h_source.html">SlepcSession.h</a>&gt;</code><br />
</div>
<p><a href="EVPOrrSommerfeldSparse__slepcz_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="EVPOrrSommerfeldSparse__slepcz_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Solves the following linear eigenvalue problem for values <picture><source srcset="form_123_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ c $" src="form_123.png" width="5" height="6"/></picture> that satisfy : </p>
<p class="formulaDsp">
<picture><source srcset="form_142_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[ \phi''(y) - \alpha^2 \phi(y) - \psi(y) = 0\,, \]" src="form_142.png" width="151" height="16"/></picture>
</p>
 <p class="formulaDsp">
<picture><source srcset="form_143_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[ \psi''(y) - \alpha^2 \psi(y) - i \alpha Re \left \{ ( U(y) - c ) \psi(y) - U''(y) \phi \right \} = 0\,, \]" src="form_143.png" width="306" height="16"/></picture>
</p>
<p> subject to <picture><source srcset="form_144_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \phi(\pm 1) = \phi'(\pm 1) = 0 $" src="form_144.png" width="109" height="14"/></picture> where <picture><source srcset="form_145_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \alpha = 1.02 $" src="form_145.png" width="46" height="9"/></picture>, <picture><source srcset="form_146_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ Re = 5772.2 $" src="form_146.png" width="66" height="10"/></picture> and <picture><source srcset="form_147_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U(y) = 1 - y^2 $" src="form_147.png" width="75" height="15"/></picture>. The matrix problem is constructed manually in this case, using second-order finite differences. A sparse eigenvalue routine is employed, via SLEPc. These values approximately correspond to the first neutral temporal mode in plane Poiseuille flow, therefore the test to be satisfied is that an eigenvalue exists with <picture><source srcset="form_148_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \Im ( c ) \approx 0 $" src="form_148.png" width="46" height="14"/></picture>. </p>

<p class="definition">Definition in file <a class="el" href="EVPOrrSommerfeldSparse__slepcz_8cpp_source.html">EVPOrrSommerfeldSparse_slepcz.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EVPOrrSommerfeldSparse__slepcz_8cpp_source.html#l00024">24</a> of file <a class="el" href="EVPOrrSommerfeldSparse__slepcz_8cpp_source.html">EVPOrrSommerfeldSparse_slepcz.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   25</span>{</div>
<div class="line"><span class="lineno">   26</span>  SlepcSession::getInstance(argc,argv);</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>  cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">   29</span>  cout &lt;&lt; <span class="stringliteral">&quot;=== EVP: Temporal spectra of the Orr-Sommerfeld eqn =\n&quot;</span>;</div>
<div class="line"><span class="lineno">   30</span>  cout &lt;&lt; <span class="stringliteral">&quot;===  with a matrix problem assembled by hand and \n&quot;</span>;</div>
<div class="line"><span class="lineno">   31</span>  cout &lt;&lt; <span class="stringliteral">&quot;===  eigenproblem solved with SLEPc sparse solver.\n&quot;</span>;</div>
<div class="line"><span class="lineno">   32</span>  cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>  <span class="comment">// discretise with these many nodal points</span></div>
<div class="line"><span class="lineno">   35</span>  <span class="keyword">const</span> std::size_t nodes( 1001 );</div>
<div class="line"><span class="lineno">   36</span>  <span class="comment">// we&#39;ll solve as TWO second order problems</span></div>
<div class="line"><span class="lineno">   37</span>  <span class="keyword">const</span> std::size_t N( 2 * nodes );</div>
<div class="line"><span class="lineno">   38</span>  <span class="comment">// domain boundaries</span></div>
<div class="line"><span class="lineno">   39</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> left = -1.0;</div>
<div class="line"><span class="lineno">   40</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> right = 1.0;</div>
<div class="line"><span class="lineno">   41</span>  <span class="comment">// spatial step for a uniform mesh</span></div>
<div class="line"><span class="lineno">   42</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> d = ( right - left ) / ( nodes - 1 );</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>  <span class="comment">// matrices for the EVP, initialised with zeroes</span></div>
<div class="line"><span class="lineno">   45</span>  <a class="code hl_class" href="classCppNoddy_1_1SparseMatrix.html">SparseMatrix&lt;D_complex&gt;</a> a( N, N );</div>
<div class="line"><span class="lineno">   46</span>  <a class="code hl_class" href="classCppNoddy_1_1SparseMatrix.html">SparseMatrix&lt;D_complex&gt;</a> b( N, N );</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>  <span class="comment">// streamwise wavenumber and Reynolds number</span></div>
<div class="line"><span class="lineno">   49</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceCppNoddy_1_1Example.html#aac1559a6834fd132928e04fa5b56e193">alpha</a> ( 1.02 );</div>
<div class="line"><span class="lineno">   50</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceCppNoddy_1_1Example.html#a7b0df38c78cae17818d668e089712330">Re</a> ( 5772.2 );</div>
<div class="line"><span class="lineno">   51</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="namespaceCppNoddy.html#a7bacbde564a8890487e34d51fab2c21b">D_complex</a> I( 0.0, 1.0 );</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>  <span class="comment">// boundary conditions at the left boundary</span></div>
<div class="line"><span class="lineno">   54</span>  a( 0, 0 ) = 1.0;           <span class="comment">// phi( left ) = 0</span></div>
<div class="line"><span class="lineno">   55</span>  a( 1, 0 ) = -1.5 / d;      <span class="comment">// phi&#39;( left ) = 0</span></div>
<div class="line"><span class="lineno">   56</span>  a( 1, 2 ) = 2.0 / d;</div>
<div class="line"><span class="lineno">   57</span>  a( 1, 4 ) = -0.5 / d;</div>
<div class="line"><span class="lineno">   58</span>  <span class="comment">// fill the interior nodes</span></div>
<div class="line"><span class="lineno">   59</span>  <span class="keywordflow">for</span> ( std::size_t i = 1; i &lt;= nodes - 2; ++i )</div>
<div class="line"><span class="lineno">   60</span>  {</div>
<div class="line"><span class="lineno">   61</span>    <span class="comment">// position in the channel</span></div>
<div class="line"><span class="lineno">   62</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> y = left + i * d;</div>
<div class="line"><span class="lineno">   63</span>    <span class="comment">// Poiseuille flow profile</span></div>
<div class="line"><span class="lineno">   64</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_enumvalue" href="BVPKarman_8cpp.html#adc29c2ff13d900c2f185ee95427fb06cac461e84f27bbb236874e1011cd66031f">U</a> = ( 1.0 - y * y );</div>
<div class="line"><span class="lineno">   65</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="namespaceCppNoddy_1_1Example.html#a52c7d099e10af0f1f05faafcf425433f">Udd</a> = -2.0;</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    <span class="comment">// the first quation at the i&#39;th nodal point</span></div>
<div class="line"><span class="lineno">   68</span>    std::size_t row = 2 * i;</div>
<div class="line"><span class="lineno">   69</span>    a( row, row ) = -2.0 / ( d * d ) - alpha * alpha;</div>
<div class="line"><span class="lineno">   70</span>    a( row, row - 2 ) = 1.0 / ( d * d );</div>
<div class="line"><span class="lineno">   71</span>    a( row, row + 2 ) = 1.0 / ( d * d );</div>
<div class="line"><span class="lineno">   72</span>    a( row, row + 1 ) = -1.0;</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>    row += 1;</div>
<div class="line"><span class="lineno">   75</span>    <span class="comment">// the second equation at the i&#39;th nodal point</span></div>
<div class="line"><span class="lineno">   76</span>    a( row, row ) = -2.0 / ( d * d ) - alpha * alpha - I * alpha * Re * <a class="code hl_enumvalue" href="BVPKarman_8cpp.html#adc29c2ff13d900c2f185ee95427fb06cac461e84f27bbb236874e1011cd66031f">U</a>;</div>
<div class="line"><span class="lineno">   77</span>    a( row, row - 2 ) = 1.0 / ( d * d );</div>
<div class="line"><span class="lineno">   78</span>    a( row, row + 2 ) = 1.0 / ( d * d );</div>
<div class="line"><span class="lineno">   79</span>    a( row, row - 1 ) = I * <a class="code hl_variable" href="namespaceCppNoddy_1_1Example.html#aac1559a6834fd132928e04fa5b56e193">alpha</a> * <a class="code hl_variable" href="namespaceCppNoddy_1_1Example.html#a7b0df38c78cae17818d668e089712330">Re</a> * <a class="code hl_function" href="namespaceCppNoddy_1_1Example.html#a52c7d099e10af0f1f05faafcf425433f">Udd</a>;</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    b( row, row ) = - I * <a class="code hl_variable" href="namespaceCppNoddy_1_1Example.html#aac1559a6834fd132928e04fa5b56e193">alpha</a> * <a class="code hl_variable" href="namespaceCppNoddy_1_1Example.html#a7b0df38c78cae17818d668e089712330">Re</a>;</div>
<div class="line"><span class="lineno">   82</span>  }</div>
<div class="line"><span class="lineno">   83</span>  <span class="comment">// boundary conditions at right boundary</span></div>
<div class="line"><span class="lineno">   84</span>  a( N - 2, N - 2 ) = 1.5 / d;</div>
<div class="line"><span class="lineno">   85</span>  a( N - 2, N - 4 ) = -2.0 / d;</div>
<div class="line"><span class="lineno">   86</span>  a( N - 2, N - 6 ) = 0.5 / d; <span class="comment">// psi&#39;( right ) = 0</span></div>
<div class="line"><span class="lineno">   87</span>  a( N - 1, N - 2 ) = 1.0;     <span class="comment">// psi( right ) = 0</span></div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>  <span class="comment">/* Note: current KSP configuration uses an LU preconditioner and MUMPS</span></div>
<div class="line"><span class="lineno">   90</span><span class="comment">    which doesn&#39;t mind zeros on the diagonal of a. */</span></div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>  <span class="comment">// a vector for storing the eigenvalues</span></div>
<div class="line"><span class="lineno">   94</span>  <a class="code hl_class" href="classCppNoddy_1_1DenseVector.html">DenseVector&lt;D_complex&gt;</a> lambdas;</div>
<div class="line"><span class="lineno">   95</span>  SparseLinearEigenSystem&lt;D_complex&gt; system( &amp;a, &amp;b );</div>
<div class="line"><span class="lineno">   96</span>  system.set_target(<a class="code hl_typedef" href="namespaceCppNoddy.html#a7bacbde564a8890487e34d51fab2c21b">D_complex</a>(0.2,0.0));</div>
<div class="line"><span class="lineno">   97</span>  system.set_nev(4);</div>
<div class="line"><span class="lineno">   98</span>  system.set_order( <span class="stringliteral">&quot;EPS_TARGET_MAGNITUDE&quot;</span> );</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>  <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  101</span>  {</div>
<div class="line"><span class="lineno">  102</span>    system.eigensolve();</div>
<div class="line"><span class="lineno">  103</span>  }</div>
<div class="line"><span class="lineno">  104</span>  <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::runtime_error &amp;error )</div>
<div class="line"><span class="lineno">  105</span>  {</div>
<div class="line"><span class="lineno">  106</span>    cout &lt;&lt; <span class="stringliteral">&quot; \033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \033[0m\n&quot;</span>;</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  108</span>  }</div>
<div class="line"><span class="lineno">  109</span>  <span class="comment">// tag any eigenvalues with imaginary part &gt; -0.1</span></div>
<div class="line"><span class="lineno">  110</span>  system.set_shift( <a class="code hl_typedef" href="namespaceCppNoddy.html#a7bacbde564a8890487e34d51fab2c21b">D_complex</a>( 0.0, -0.1 ) );</div>
<div class="line"><span class="lineno">  111</span>  system.tag_eigenvalues_upper( + 1 );</div>
<div class="line"><span class="lineno">  112</span>  lambdas = system.get_tagged_eigenvalues();</div>
<div class="line"><span class="lineno">  113</span>  lambdas.<a class="code hl_function" href="classCppNoddy_1_1DenseVector.html#a4e70e0e58d05b44ff5c3adcfedc97072">dump</a>();</div>
<div class="line"><span class="lineno">  114</span>  <span class="keywordtype">double</span> min_growth_rate( lambdas[ 0 ].<a class="code hl_function" href="namespaceCppNoddy_1_1Utility.html#aa91e621301363a552d19136f48bc7b52">imag</a>() );</div>
<div class="line"><span class="lineno">  115</span>  <span class="comment">// make sure we have a near neutral mode</span></div>
<div class="line"><span class="lineno">  116</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> tol = 1.e-3;</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>  std::string dirname(<span class="stringliteral">&quot;./DATA&quot;</span>);</div>
<div class="line"><span class="lineno">  119</span>  mkdir( dirname.c_str(), S_IRWXU );</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <a class="code hl_class" href="classCppNoddy_1_1TrackerFile.html">TrackerFile</a> spectrum( <span class="stringliteral">&quot;./DATA/spectrum.dat&quot;</span> );</div>
<div class="line"><span class="lineno">  122</span>  spectrum.push_ptr( &amp;lambdas, <span class="stringliteral">&quot;evs&quot;</span> );</div>
<div class="line"><span class="lineno">  123</span>  spectrum.update();</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>  <span class="comment">// eigenfunctions</span></div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_class" href="classCppNoddy_1_1DenseMatrix.html">DenseMatrix&lt;D_complex&gt;</a> eigenvectors;</div>
<div class="line"><span class="lineno">  127</span>  eigenvectors = system.get_tagged_eigenvectors();</div>
<div class="line"><span class="lineno">  128</span>  <a class="code hl_class" href="classCppNoddy_1_1DenseVector.html">DenseVector&lt;double&gt;</a> ynodes = <a class="code hl_function" href="namespaceCppNoddy_1_1Utility.html#afd0e606fc3cc8f0e001b68758c930cd6">Utility::uniform_node_vector</a>(left,right,nodes);</div>
<div class="line"><span class="lineno">  129</span>  <a class="code hl_class" href="classCppNoddy_1_1OneD__Node__Mesh.html">OneD_Node_Mesh&lt;D_complex&gt;</a> mesh( ynodes, 4 );</div>
<div class="line"><span class="lineno">  130</span>  <span class="comment">// non-zero eigenvalue list =&gt; dump index 0 mode</span></div>
<div class="line"><span class="lineno">  131</span>  <span class="keywordflow">if</span> ( lambdas.<a class="code hl_function" href="classCppNoddy_1_1DenseVector.html#a217b6c4f92b41619cddf19d23286bc32">nelts</a>() &gt; 0 ) {    </div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordtype">int</span> index(0);</div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; nodes; ++i ) {</div>
<div class="line"><span class="lineno">  134</span>      mesh(i,0) = eigenvectors(index,2*i+0); <span class="comment">//phi_i</span></div>
<div class="line"><span class="lineno">  135</span>      mesh(i,1) = eigenvectors(index,2*i+1); <span class="comment">//psi_i</span></div>
<div class="line"><span class="lineno">  136</span>    }</div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 1; i &lt; nodes-1; ++i ) {</div>
<div class="line"><span class="lineno">  138</span>      mesh(i,2) = (mesh(i+1,0)-mesh(i-1,0))/(2*d); <span class="comment">//u_i=phi&#39;</span></div>
<div class="line"><span class="lineno">  139</span>      mesh(i,3) = -I*<a class="code hl_variable" href="namespaceCppNoddy_1_1Example.html#aac1559a6834fd132928e04fa5b56e193">alpha</a>*mesh(i,0);              <span class="comment">//v_i=-i*alpha*phi</span></div>
<div class="line"><span class="lineno">  140</span>    }</div>
<div class="line"><span class="lineno">  141</span>  }</div>
<div class="line"><span class="lineno">  142</span>  mesh.normalise(0);</div>
<div class="line"><span class="lineno">  143</span>  mesh.dump_gnu(<span class="stringliteral">&quot;./DATA/eigenmode.dat&quot;</span>);</div>
<div class="line"><span class="lineno">  144</span>  </div>
<div class="line"><span class="lineno">  145</span>  <span class="keywordflow">if</span> ( std::abs( min_growth_rate ) &lt; tol )</div>
<div class="line"><span class="lineno">  146</span>  {</div>
<div class="line"><span class="lineno">  147</span>    cout &lt;&lt; <span class="stringliteral">&quot;\033[1;32;48m  * PASSED \033[0m\n&quot;</span>;</div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  149</span>  }</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>  cout &lt;&lt; <span class="stringliteral">&quot;\033[1;31;48m  * FAILED \033[0m\n&quot;</span>;</div>
<div class="line"><span class="lineno">  152</span>  cout &lt;&lt; <span class="stringliteral">&quot;    Final error = &quot;</span> &lt;&lt; min_growth_rate &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  153</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  154</span>  </div>
<div class="line"><span class="lineno">  155</span>}</div>
<div class="ttc" id="aBVPKarman_8cpp_html_adc29c2ff13d900c2f185ee95427fb06cac461e84f27bbb236874e1011cd66031f"><div class="ttname"><a href="BVPKarman_8cpp.html#adc29c2ff13d900c2f185ee95427fb06cac461e84f27bbb236874e1011cd66031f">U</a></div><div class="ttdeci">@ U</div><div class="ttdef"><b>Definition:</b> <a href="BVPKarman_8cpp_source.html#l00020">BVPKarman.cpp:20</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1DenseMatrix_html"><div class="ttname"><a href="classCppNoddy_1_1DenseMatrix.html">CppNoddy::DenseMatrix</a></div><div class="ttdoc">A matrix class that constructs a DENSE matrix as a row major std::vector of DenseVectors.</div><div class="ttdef"><b>Definition:</b> <a href="DenseMatrix_8h_source.html#l00025">DenseMatrix.h:25</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1DenseVector_html"><div class="ttname"><a href="classCppNoddy_1_1DenseVector.html">CppNoddy::DenseVector</a></div><div class="ttdoc">An DenseVector class â€“ a dense vector object.</div><div class="ttdef"><b>Definition:</b> <a href="DenseVector_8h_source.html#l00034">DenseVector.h:34</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1DenseVector_html_a217b6c4f92b41619cddf19d23286bc32"><div class="ttname"><a href="classCppNoddy_1_1DenseVector.html#a217b6c4f92b41619cddf19d23286bc32">CppNoddy::DenseVector::nelts</a></div><div class="ttdeci">std::size_t nelts() const</div><div class="ttdoc">Get the number of elements in the vector Since the vector is dense, the number of elements is the siz...</div><div class="ttdef"><b>Definition:</b> <a href="DenseVector_8h_source.html#l00335">DenseVector.h:335</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1DenseVector_html_a4e70e0e58d05b44ff5c3adcfedc97072"><div class="ttname"><a href="classCppNoddy_1_1DenseVector.html#a4e70e0e58d05b44ff5c3adcfedc97072">CppNoddy::DenseVector::dump</a></div><div class="ttdeci">void dump() const</div><div class="ttdoc">Dump to std::cout.</div><div class="ttdef"><b>Definition:</b> <a href="src_2DenseVector_8cpp_source.html#l00064">DenseVector.cpp:64</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1OneD__Node__Mesh_html"><div class="ttname"><a href="classCppNoddy_1_1OneD__Node__Mesh.html">CppNoddy::OneD_Node_Mesh</a></div><div class="ttdoc">A one dimensional mesh utility object.</div><div class="ttdef"><b>Definition:</b> <a href="OneD__Node__Mesh_8h_source.html#l00024">OneD_Node_Mesh.h:24</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1SparseMatrix_html"><div class="ttname"><a href="classCppNoddy_1_1SparseMatrix.html">CppNoddy::SparseMatrix</a></div><div class="ttdoc">A matrix class that constructs a SPARSE matrix as a row major std::vector of SparseVectors.</div><div class="ttdef"><b>Definition:</b> <a href="SparseMatrix_8h_source.html#l00031">SparseMatrix.h:31</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1TrackerFile_html"><div class="ttname"><a href="classCppNoddy_1_1TrackerFile.html">CppNoddy::TrackerFile</a></div><div class="ttdef"><b>Definition:</b> <a href="TrackerFile_8h_source.html#l00017">TrackerFile.h:17</a></div></div>
<div class="ttc" id="anamespaceCppNoddy_1_1Example_html_a52c7d099e10af0f1f05faafcf425433f"><div class="ttname"><a href="namespaceCppNoddy_1_1Example.html#a52c7d099e10af0f1f05faafcf425433f">CppNoddy::Example::Udd</a></div><div class="ttdeci">double Udd(double y)</div><div class="ttdoc">Globally define the base flow curvature.</div><div class="ttdef"><b>Definition:</b> <a href="EVPOrrSommerfeldEasy__lapack_8cpp_source.html#l00041">EVPOrrSommerfeldEasy_lapack.cpp:41</a></div></div>
<div class="ttc" id="anamespaceCppNoddy_1_1Example_html_a7b0df38c78cae17818d668e089712330"><div class="ttname"><a href="namespaceCppNoddy_1_1Example.html#a7b0df38c78cae17818d668e089712330">CppNoddy::Example::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Globally define the Reynolds number and wavenumber.</div><div class="ttdef"><b>Definition:</b> <a href="EVPOrrSommerfeldEasy__lapack_8cpp_source.html#l00034">EVPOrrSommerfeldEasy_lapack.cpp:34</a></div></div>
<div class="ttc" id="anamespaceCppNoddy_1_1Example_html_aac1559a6834fd132928e04fa5b56e193"><div class="ttname"><a href="namespaceCppNoddy_1_1Example.html#aac1559a6834fd132928e04fa5b56e193">CppNoddy::Example::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdef"><b>Definition:</b> <a href="EVPOrrSommerfeldEasy__lapack_8cpp_source.html#l00034">EVPOrrSommerfeldEasy_lapack.cpp:34</a></div></div>
<div class="ttc" id="anamespaceCppNoddy_1_1Utility_html_aa91e621301363a552d19136f48bc7b52"><div class="ttname"><a href="namespaceCppNoddy_1_1Utility.html#aa91e621301363a552d19136f48bc7b52">CppNoddy::Utility::imag</a></div><div class="ttdeci">DenseVector&lt; double &gt; imag(const DenseVector&lt; D_complex &gt; &amp;X)</div><div class="ttdoc">Return a double DENSE vector containing the imaginary part of a complex DENSE vector.</div><div class="ttdef"><b>Definition:</b> <a href="Utility_8cpp_source.html#l00185">Utility.cpp:185</a></div></div>
<div class="ttc" id="anamespaceCppNoddy_1_1Utility_html_afd0e606fc3cc8f0e001b68758c930cd6"><div class="ttname"><a href="namespaceCppNoddy_1_1Utility.html#afd0e606fc3cc8f0e001b68758c930cd6">CppNoddy::Utility::uniform_node_vector</a></div><div class="ttdeci">DenseVector&lt; double &gt; uniform_node_vector(const double &amp;lower, const double &amp;upper, const std::size_t &amp;N)</div><div class="ttdoc">Return a DENSE vector with the nodal points of a uniform mesh distributed between the upper/lower bou...</div><div class="ttdef"><b>Definition:</b> <a href="Utility_8cpp_source.html#l00113">Utility.cpp:113</a></div></div>
<div class="ttc" id="anamespaceCppNoddy_html_a7bacbde564a8890487e34d51fab2c21b"><div class="ttname"><a href="namespaceCppNoddy.html#a7bacbde564a8890487e34d51fab2c21b">CppNoddy::D_complex</a></div><div class="ttdeci">std::complex&lt; double &gt; D_complex</div><div class="ttdoc">A complex double precision number using std::complex.</div><div class="ttdef"><b>Definition:</b> <a href="include_2Types_8h_source.html#l00098">Types.h:98</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="src_2DenseVector_8cpp_source.html#l00064">CppNoddy::DenseVector&lt; _Type &gt;::dump()</a>, <a class="el" href="classCppNoddy_1_1OneD__Node__Mesh.html#affbfd2a8ef3f5852f45681486a58298a">CppNoddy::OneD_Node_Mesh&lt; _Type, _Xtype &gt;::dump_gnu()</a>, <a class="el" href="DenseVector_8h_source.html#l00335">CppNoddy::DenseVector&lt; _Type &gt;::nelts()</a>, <a class="el" href="OneD__Node__Mesh_8h_source.html#l00184">CppNoddy::OneD_Node_Mesh&lt; _Type, _Xtype &gt;::normalise()</a>, <a class="el" href="TrackerFile_8cpp_source.html#l00027">CppNoddy::TrackerFile::push_ptr()</a>, <a class="el" href="BVPKarman_8cpp_source.html#l00020">U</a>, <a class="el" href="Utility_8cpp_source.html#l00113">CppNoddy::Utility::uniform_node_vector()</a>, and <a class="el" href="TrackerFile_8cpp_source.html#l00118">CppNoddy::TrackerFile::update()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 1 1980 00:00:00 for CppNoddy by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.5
</small></address>
<p>&copy; 2012 </p> <a href="http://hewitt.ddns.net"> R.E. Hewitt</a>
</body>
</html>
